<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Water Consumption Anomaly Detector | City of Delta Tools</title>
  <link rel="icon" type="image/png" href="/frontend/logo.png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
    }

    body {
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 25%, #16213e 50%, #1a1a2e 75%, #0a0a0a 100%);
      color: #ffffff;
      overflow-x: hidden;
      position: relative;
    }

    /* Navigation - Keep exactly the same */
    .navigation {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      align-items: center;
      gap: 30px;
      z-index: 100;
      background: rgba(10, 10, 10, 0.1);
      backdrop-filter: blur(15px);
      padding: 12px 25px;
      border-radius: 50px;
      border: 1px solid rgba(0, 255, 255, 0.1);
    }

    .logo {
      height: 60px;
      width: auto;
      filter: drop-shadow(0 0 5px rgba(0, 255, 255, 0.3));
      transition: all 0.3s ease;
      object-fit: contain;
      object-position: center;
      cursor: pointer;
    }

    .logo:hover {
      filter: drop-shadow(0 0 8px rgba(0, 255, 255, 0.5));
      transform: scale(1.05);
    }

    nav {
      display: flex;
      gap: 25px;
    }

    nav a {
      color: #ffffff;
      text-decoration: none;
      font-weight: 600;
      font-size: 1rem;
      position: relative;
      transition: all 0.3s ease;
      padding: 6px 14px;
      border-radius: 20px;
    }

    nav a::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 50%;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, #00ffff, #0080ff);
      transition: all 0.3s ease;
      transform: translateX(-50%);
    }

    nav a:hover::after {
      width: 100%;
    }

    nav a:hover {
      color: #00ffff;
      text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
      background: rgba(0, 255, 255, 0.1);
    }

    /* Dropdown styles */
    .dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      background: rgba(10, 10, 10, 0.95);
      backdrop-filter: blur(15px);
      min-width: 200px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      border-radius: 15px;
      border: 1px solid rgba(0, 255, 255, 0.2);
      z-index: 1000;
      margin-top: 10px;
      padding: 10px 0;
    }

    .dropdown-content a {
      color: #ffffff;
      padding: 12px 20px;
      text-decoration: none;
      display: block;
      font-size: 0.9rem;
      transition: all 0.3s ease;
      border-radius: 0;
    }

    .dropdown-content a:hover {
      background: rgba(0, 255, 255, 0.1);
      color: #00ffff;
      transform: translateX(5px);
    }

    .dropdown:hover .dropdown-content {
      display: block;
    }

    .dropdown-content:hover {
      display: block;
    }

    /* Empty dropdown for alignment */
    .dropdown.empty .dropdown-content {
      display: none !important;
    }

    /* Horizontal Tech Background */
    .tech-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
    }

    .radar-line {
      position: absolute;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.6), transparent);
      height: 1px;
      animation: radar-sweep 3s infinite linear;
    }

    .radar-line:nth-child(1) {
      top: 20%;
      width: 100%;
      animation-delay: 0s;
    }

    .radar-line:nth-child(2) {
      top: 40%;
      width: 100%;
      animation-delay: 1s;
    }

    .radar-line:nth-child(3) {
      top: 60%;
      width: 100%;
      animation-delay: 2s;
    }

    .radar-line:nth-child(4) {
      top: 80%;
      width: 100%;
      animation-delay: 0.5s;
    }

    @keyframes radar-sweep {
      0% {
        transform: translateX(-100%);
        opacity: 0;
      }
      50% {
        opacity: 1;
      }
      100% {
        transform: translateX(100%);
        opacity: 0;
      }
    }

    .connection-node {
      position: absolute;
      width: 4px;
      height: 4px;
      background: rgba(0, 255, 255, 0.8);
      border-radius: 50%;
      animation: node-pulse 3s infinite;
    }

    .connection-node:nth-child(5) {
      top: 15%;
      left: 20%;
      animation-delay: 0s;
    }

    .connection-node:nth-child(6) {
      top: 35%;
      right: 25%;
      animation-delay: 1s;
    }

    .connection-node:nth-child(7) {
      top: 55%;
      left: 30%;
      animation-delay: 2s;
    }

    .connection-node:nth-child(8) {
      top: 75%;
      right: 15%;
      animation-delay: 0.5s;
    }

    @keyframes node-pulse {
      0%, 100% {
        transform: scale(1);
        opacity: 0.8;
        box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
      }
      50% {
        transform: scale(1.5);
        opacity: 1;
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
      }
    }

    .radar-circle {
      position: absolute;
      border: 1px solid rgba(0, 255, 255, 0.2);
      border-radius: 50%;
      animation: radar-pulse 6s infinite;
    }

    .radar-circle:nth-child(9) {
      top: 25%;
      left: 5%;
      width: 200px;
      height: 200px;
      animation-delay: 0s;
    }

    .radar-circle:nth-child(10) {
      top: 75%;
      right: 5%;
      width: 150px;
      height: 150px;
      animation-delay: 3s;
    }

    @keyframes radar-pulse {
      0% {
        transform: scale(0.8);
        opacity: 0.3;
        border-color: rgba(0, 255, 255, 0.2);
      }
      50% {
        transform: scale(1.1);
        opacity: 0.6;
        border-color: rgba(0, 255, 255, 0.4);
      }
      100% {
        transform: scale(0.8);
        opacity: 0.3;
        border-color: rgba(0, 255, 255, 0.2);
      }
    }

    /* Main Container */
    .main-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      padding: 120px 20px 40px;
      max-width: 900px;
      margin: 0 auto;
      text-align: center;
      background: none;
    }

    /* Tool Title */
    .tool-title {
      font-size: 4rem;
      font-weight: 900;
      margin-bottom: 30px;
      color: #00ffff;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 18px;
      letter-spacing: -1px;
    }

    .water-droplet {
      font-size: 3rem;
      animation: water-bounce 3s ease-in-out infinite;
      filter: drop-shadow(0 0 15px rgba(0, 123, 255, 0.4));
    }

    @keyframes water-bounce {
      0%, 100% {
        transform: translateY(0) scale(1);
      }
      25% {
        transform: translateY(-10px) scale(1.1);
      }
      50% {
        transform: translateY(0) scale(1);
      }
      75% {
        transform: translateY(-5px) scale(1.05);
      }
    }

    /* Step Section */
    .step-section {
      background: rgba(10, 10, 10, 0.6);
      border: 1px solid rgba(0, 255, 255, 0.12);
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
      text-align: left;
      width: 100%;
      margin-bottom: 30px;
    }

    .step-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #00ffff;
      margin-bottom: 8px;
    }

    .step-subtitle {
      font-size: 1rem;
      color: #a8b3cf;
      margin-bottom: 20px;
    }

    /* Upload Area */
    .upload-area {
      background: rgba(255, 255, 255, 0.04);
      border: 2px dashed rgba(0, 255, 255, 0.3);
      border-radius: 12px;
      padding: 30px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .upload-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .upload-icon {
      font-size: 2.2rem;
      color: #b0c4d6;
      margin-bottom: 0;
      margin-right: 0;
    }

    .upload-text {
      font-size: 1.1rem;
      color: #e0e0e0;
      font-weight: 500;
      margin-bottom: 0;
    }

    .upload-hint {
      font-size: 0.9rem;
      color: #b0b0b0;
      margin-bottom: 0;
      margin-left: 8px;
    }

    .browse-btn {
      background: #6c757d;
      color: white;
      border: none;
      padding: 10px 22px;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-right: 32px;
      margin-left: auto;
      align-self: center;
    }

    .upload-area input[type="file"] {
      display: none;
    }

    .upload-area:hover {
      border-color: #007bff;
      background: rgba(255, 255, 255, 0.13) !important;
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 123, 255, 0.15);
    }

    .upload-area.dragover {
      border-color: #007bff;
      background: #e3f2fd;
    }

    .upload-area.file-selected {
      background: rgba(0, 123, 255, 0.1);
      border-color: #007bff;
    }
    
    .upload-area.file-uploaded {
      background: rgba(40, 167, 69, 0.2) !important;
      border: 3px solid #28a745 !important;
      box-shadow: 0 0 15px rgba(40, 167, 69, 0.4) !important;
    }

    /* Interactive Elements */
    .upload-area::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 123, 255, 0.1), transparent);
      transition: left 0.5s ease;
    }

    .upload-area:hover::before {
      left: 100%;
    }

    /* Process Button */
    .process-btn {
      background: linear-gradient(135deg, #007bff, #0056b3);
      color: white;
      font-weight: 600;
      padding: 15px 40px;
      border: none;
      border-radius: 10px;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
      box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
      margin-top: 20px;
    }

    .process-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 123, 255, 0.4);
    }

    .process-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    /* Progress Section */
    .progress-section {
      background: rgba(0, 123, 255, 0.05);
      border-radius: 12px;
      padding: 30px;
      border: 1px solid rgba(0, 123, 255, 0.2);
      width: 100%;
      display: none;
      margin-top: 30px;
      backdrop-filter: blur(10px);
    }

    .progress-bar-container {
      background: #e9ecef;
      border-radius: 10px;
      height: 20px;
      margin: 20px 0;
      overflow: hidden;
    }

    .progress-bar {
      background: linear-gradient(90deg, #007bff, #0056b3);
      height: 100%;
      width: 0%;
      transition: width 0.3s ease;
      border-radius: 10px;
    }

    .progress-text {
      color: #007bff;
      font-weight: 600;
      margin-bottom: 15px;
      font-size: 1.1rem;
    }

    .timer-text {
      color: #6c757d;
      font-weight: 500;
      margin-bottom: 10px;
      font-size: 0.9rem;
    }

    /* How it Works Section */
    .how-it-works-section {
      margin-top: 100px;
      width: 100%;
      padding: 0;
      background: none;
      border-radius: 0;
      text-align: center;
    }

    .how-it-works-title {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 50px;
      color: #00ffff;
      letter-spacing: 1px;
    }

    .how-it-works-timeline {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 38px;
      max-width: 700px;
      margin: 0 auto;
      position: relative;
    }

    .how-timeline-step {
      display: flex;
      align-items: flex-start;
      gap: 22px;
      position: relative;
    }

    .how-timeline-number {
      font-size: 1.1rem;
      font-weight: 900;
      color: #fff;
      min-width: 34px;
      min-height: 34px;
      width: 34px;
      height: 34px;
      text-align: center;
      line-height: 34px;
      border-radius: 50%;
      background: linear-gradient(135deg, #7ee8fa 0%, #00c6fb 40%, #005bea 100%);
      box-shadow: 0 0 10px rgba(0, 191, 255, 0.18);
      margin-top: 2px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .how-timeline-content {
      text-align: left;
      color: #fff;
      max-width: 600px;
    }

    .how-timeline-heading {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 6px;
      color: #00eaff;
      letter-spacing: 0.5px;
    }

    .how-timeline-desc {
      font-size: 1.05rem;
      font-weight: 400;
      color: #e0f7fa;
      line-height: 1.6;
    }

    .how-it-works-timeline::before {
      content: '';
      position: absolute;
      left: 16px;
      top: 0;
      width: 2px;
      height: 100%;
      background: linear-gradient(to bottom, #00eaff 0%, #005bea 100%);
      opacity: 0.18;
      z-index: 0;
    }

    .how-timeline-step:last-child .how-timeline-content {
      margin-bottom: 0;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .navigation { top: 10px; gap: 8px; padding: 10px 14px; flex-wrap: wrap; max-width: calc(100% - 16px); justify-content: center; }
      nav a { font-size: 0.82rem; padding: 4px 8px; white-space: nowrap; }
      .logo { height: 36px; }
      .main-container { padding-top: 150px; }
      .tool-title {
        font-size: 2.5rem;
      }

      .step-title {
        font-size: 1.3rem;
      }

      .upload-area {
        flex-direction: column;
        gap: 20px;
        text-align: center;
      }

      .browse-btn {
        margin-right: 0;
        margin-left: 0;
      }

      .how-it-works-title {
        font-size: 2rem;
      }

      .how-it-works-timeline {
        gap: 30px;
      }
    }
    @media (max-width: 480px) {
      .navigation { top: 8px; padding: 6px 10px; gap: 6px; max-width: calc(100% - 12px); }
      nav a { font-size: 0.7rem; padding: 2px 6px; }
      .logo { height: 26px; }
      .main-container { padding-top: 165px; }
    }
    @media (max-width: 400px) {
      .navigation { top: 6px; padding: 6px 8px; gap: 4px; }
      nav a { font-size: 0.64rem; padding: 2px 4px; }
      .logo { height: 24px; }
      .main-container { padding-top: 175px; }
    }
  </style>
</head>
<body>
  <!-- Horizontal Tech Background -->
  <div class="tech-background">
    <div class="radar-line"></div>
    <div class="radar-line"></div>
    <div class="radar-line"></div>
    <div class="radar-line"></div>
    <div class="connection-node"></div>
    <div class="connection-node"></div>
    <div class="connection-node"></div>
    <div class="connection-node"></div>
    <div class="radar-circle"></div>
    <div class="radar-circle"></div>
  </div>

  <!-- Navigation -->
  <div class="navigation">
    <img src="/frontend/logo.png" alt="Logo" class="logo" id="homeLogo">
    <nav>
      <div class="dropdown">
        <a href="/#about">About</a>
        <div class="dropdown-content">
          <a href="/#education">Education</a>
          <a href="/#work">Work Experience</a>
          <a href="/#certifications">Certificates</a>
          <a href="/#skills">Skills</a>
        </div>
      </div>
      <div class="dropdown empty">
        <a href="/projects">Projects</a>
        <div class="dropdown-content"></div>
      </div>
      <div class="dropdown">
        <a href="/#delta-tools">City of Delta</a>
        <div class="dropdown-content">
          <a href="/meter-form-processor">Meter Form Processor</a>
          <a href="/single-occupancy-discount">Single Occupancy Discount Form Processor</a>
          <a href="/secondary-suite-exemption">Secondary Suite Exemption Form Processor</a>
          <a href="/water-consumption-anomaly">Water Consumption Anomaly Detector</a>
          <a href="/sql-query-generator">SQL Query Generator</a>
          <a href="#">Other Tools</a>
        </div>
      </div>
      <div class="dropdown empty">
        <a href="/contact">Contact</a>
        <div class="dropdown-content"></div>
      </div>
    </nav>
  </div>

  <!-- Main Content -->
  <div class="main-container">
    <!-- Floating Title -->
    <h1 class="tool-title">
      <span class="water-droplet">💧</span>
      Water Consumption Anomaly Detector
      <span class="water-droplet">💧</span>
    </h1>
    
    <!-- Step 1: Upload Water Consumption Data -->
    <div class="step-section">
      <h2 class="step-title">Step 1: Upload Water Consumption Data</h2>
      <p class="step-subtitle">Upload consumption values, meter status, history notes, for every water meter in the city</p>
      
      <div class="upload-area" id="upload_area" onclick="document.getElementById('file_input').click()">
        <div class="upload-left">
          <div class="upload-icon">☁️</div>
          <div>
            <div class="upload-text">Drag and drop consumption data file here</div>
            <div class="upload-hint">Limit 200MB per file • CSV, XLSX</div>
          </div>
        </div>
        <button type="button" class="browse-btn" onclick="event.stopPropagation(); document.getElementById('file_input').click()">Browse files</button>
        <input type="file" id="file_input" accept=".csv,.xlsx" />
      </div>
      <div id="file_status"></div>
    </div>

    <!-- Process Button -->
    <button id="process_btn" class="process-btn" onclick="processData()">🚀 Process Data</button>

    <!-- Progress Section -->
    <div class="progress-section" id="progress_section">
      <div class="progress-text" id="progress_text">Processing...</div>
      <div class="timer-text" id="timer_text">Time elapsed: 0.0s</div>
      <div class="progress-bar-container">
        <div class="progress-bar" id="progress_bar"></div>
      </div>
      <div id="processing_status"></div>
    </div>

    <!-- How it Works Section -->
    <div class="how-it-works-section">
      <h2 class="how-it-works-title">How it Works</h2>
      <div class="how-it-works-timeline">
        <div class="how-timeline-step">
          <div class="how-timeline-number">1</div>
          <div class="how-timeline-content">
            <div class="how-timeline-heading">Historical leak analysis & pattern recognition</div>
            <div class="how-timeline-desc">The system analyzes history notes for each account to identify meters that previously had leaks or dead batteries. It examines cases where new consumption values were significantly higher or lower than normal for the account, indicating either a water leak (unusually high consumption) or a dead meter (unusually low or zero consumption). This historical data provides the foundation for supervised learning.</div>
          </div>
        </div>
        <div class="how-timeline-step">
          <div class="how-timeline-number">2</div>
          <div class="how-timeline-content">
            <div class="how-timeline-heading">Supervised learning model training</div>
            <div class="how-timeline-desc">Previous confirmed leaks and meter failures are used to train a supervised learning model using scikit-learn. The model learns patterns from historical data including consumption patterns, meter age, property characteristics, and seasonal variations to predict potential leaks and dead meters.</div>
          </div>
        </div>
        <div class="how-timeline-step">
          <div class="how-timeline-number">3</div>
          <div class="how-timeline-content">
            <div class="how-timeline-heading">Isolation Forest anomaly detection</div>
            <div class="how-timeline-desc">The system employs Isolation Forest algorithms from scikit-learn's ensemble module to perform unsupervised anomaly detection. This method isolates data points that are statistically different from the majority, identifying unusual consumption patterns that may indicate leaks or meter malfunctions without requiring labeled training data.</div>
          </div>
        </div>
        <div class="how-timeline-step">
          <div class="how-timeline-number">4</div>
          <div class="how-timeline-content">
            <div class="how-timeline-heading">Multi-algorithm filtering & refinement</div>
            <div class="how-timeline-desc">Results from both supervised and unsupervised learning algorithms are combined and filtered using preset parameters. Additional filtering is applied based on account details such as meter age, property ownership changes, seasonal patterns, and neighborhood consumption averages to reduce false positives and improve detection accuracy.</div>
          </div>
        </div>
        <div class="how-timeline-step">
          <div class="how-timeline-number">5</div>
          <div class="how-timeline-content">
            <div class="how-timeline-heading">Final anomaly report generation</div>
            <div class="how-timeline-desc">The system creates a comprehensive Excel output containing flagged accounts identified by both collective algorithms (supervised + unsupervised) as having potential leaks or dead meters. The report includes account details, consumption patterns, confidence scores, and recommended actions, enabling city staff to efficiently identify and contact affected property owners.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Logo click to go home
    document.getElementById('homeLogo').addEventListener('click', function() {
      window.location.href = '/';
    });

    let fileUploaded = null;
    let startTime = null;
    let timerInterval = null;

    // Setup drag and drop
    const uploadArea = document.getElementById('upload_area');
    const fileInput = document.getElementById('file_input');

    uploadArea.addEventListener('dragover', function(e) {
      e.preventDefault();
      uploadArea.classList.add('dragover');
    });

    uploadArea.addEventListener('dragleave', function(e) {
      e.preventDefault();
      uploadArea.classList.remove('dragover');
    });

    uploadArea.addEventListener('drop', function(e) {
      e.preventDefault();
      uploadArea.classList.remove('dragover');
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        fileInput.files = files;
        updateFileDisplay(files[0]);
      }
    });

    fileInput.addEventListener('change', function(e) {
      if (e.target.files.length > 0) {
        updateFileDisplay(e.target.files[0]);
      }
    });

    function updateFileDisplay(file) {
      fileUploaded = file;
      const statusDiv = document.getElementById('file_status');
      statusDiv.innerHTML = `<div style="color: #00ff88; margin-top: 10px;">✅ File selected: ${file.name}</div>`;
      
      // Update upload area appearance
      const uploadArea = document.getElementById('upload_area');
      const uploadIcon = uploadArea.querySelector('.upload-icon');
      const uploadText = uploadArea.querySelector('.upload-text');
      const uploadHint = uploadArea.querySelector('.upload-hint');
      
      uploadIcon.textContent = '✅';
      uploadText.textContent = file.name;
      uploadHint.textContent = 'File uploaded successfully!';
      uploadArea.classList.add('file-selected');
      
      // Add green border to indicate successful upload
      setTimeout(() => {
        uploadArea.classList.add('file-uploaded');
      }, 500); // Small delay to show the transition
    }

    function startTimer() {
      startTime = Date.now();
      timerInterval = setInterval(updateTimer, 100);
    }

    function stopTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
    }

    function updateTimer() {
      if (startTime) {
        const elapsed = (Date.now() - startTime) / 1000;
        document.getElementById('timer_text').textContent = `Time elapsed: ${elapsed.toFixed(1)}s`;
      }
    }

    // Dropdown hover delay functionality
    const dropdowns = document.querySelectorAll('.dropdown');
    let hideTimeout;

    dropdowns.forEach(dropdown => {
      const dropdownContent = dropdown.querySelector('.dropdown-content');
      
      dropdown.addEventListener('mouseenter', () => {
        clearTimeout(hideTimeout);
        dropdownContent.style.display = 'block';
      });
      
      dropdown.addEventListener('mouseleave', () => {
        hideTimeout = setTimeout(() => {
          dropdownContent.style.display = 'none';
        }, 300); // 0.3 second delay
      });
      
      dropdownContent.addEventListener('mouseenter', () => {
        clearTimeout(hideTimeout);
      });
      
      dropdownContent.addEventListener('mouseleave', () => {
        hideTimeout = setTimeout(() => {
          dropdownContent.style.display = 'none';
        }, 300); // 0.3 second delay
      });
    });

    async function processData() {
      const processBtn = document.getElementById('process_btn');
      const progressSection = document.getElementById('progress_section');
      const progressText = document.getElementById('progress_text');
      const progressBar = document.getElementById('progress_bar');
      
      if (!fileUploaded) {
        alert('Please select a file to upload.');
        return;
      }

      processBtn.disabled = true;
      processBtn.textContent = 'Processing...';
      progressSection.style.display = 'block';
      progressText.textContent = 'Initializing process...';
      progressBar.style.width = '5%';
      progressBar.style.backgroundColor = '#007bff';
      
      // Start timer
      startTimer();

      try {
        // Single concise flow: show Processing… for exactly 2.3s, then deny
        progressText.textContent = 'Processing...';
        progressBar.style.width = '50%';
        await new Promise(resolve => setTimeout(resolve, 2300));

        progressText.textContent = 'ACCESS DENIED';
        progressBar.style.width = '100%';
        progressBar.style.backgroundColor = '#ff4444';
        processBtn.disabled = false;
        processBtn.textContent = '🚀 Process Data';
        stopTimer();
        return;

      } catch (err) {
        progressText.textContent = 'ACCESS DENIED';
        progressBar.style.width = '100%';
        progressBar.style.backgroundColor = '#ff4444';
        processBtn.disabled = false;
        processBtn.textContent = '🚀 Process Data';
        stopTimer();
      }
    }
  </script>
</body>
</html> 